<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>لوحة الأدمن</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="logo">
      <div class="mark">عق</div>
      <div><div style="font-weight:800">لوحة الأدمن</div></div>
    </div>
    <div style="margin-left:auto;padding-right:16px">
      <button class="btn" id="toHome">الرئيسية</button>
      <button class="btn" id="logout">خروج</button>
    </div>
  </header>

  <main class="container" style="max-width:800px;margin-top:20px">
    <div class="auth-area">
      <h3>إضافة عقار جديد</h3>
      <form id="addProp">
        <input id="title" placeholder="العنوان" required />
        <input id="price" placeholder="السعر" required />
        <input id="rooms" placeholder="عدد الغرف (رقم)" required />
        <input id="type" placeholder="النوع (apartment/villa/shop)" required />
        <input id="city" placeholder="المدينة" required />
        <input id="img" placeholder="رابط الصورة" required />
        <textarea id="desc" placeholder="الوصف"></textarea>
        <button class="btn" type="submit">إضافة (محليًا)</button>
      </form>
      <p style="margin-top:12px;color:#666">ملاحظة: الإضافة هنا تحفظ محليًا في المتصفح فقط. لتخزين دائم على الموقع، افتح ملف <code>data/properties.json</code> في الريبو وعدل هناك يدوياً، أو ربط GitHub API لاحقًا.</p>
    </div>
  </main>

  <script>
    // guard: only allow admin
    const user = JSON.parse(localStorage.getItem('realestate_user') || '{}');
    if(!user.email || user.email.toLowerCase() !== 'kaidowork112@gmail.com'){
      alert('غير مسموح: ادخل كأدمن');
      location.href = 'login.html';
    }
    document.getElementById('toHome').onclick = ()=>location.href='index.html';
    document.getElementById('logout').onclick = ()=>{ localStorage.removeItem('realestate_user'); location.href='index.html'; }

    document.getElementById('addProp').onsubmit = (e)=>{
      e.preventDefault();
      const obj = {
        id: Date.now(),
        title: document.getElementById('title').value,
        price: document.getElementById('price').value,
        rooms: Number(document.getElementById('rooms').value),
        type: document.getElementById('type').value,
        city: document.getElementById('city').value,
        img: document.getElementById('img').value,
        desc: document.getElementById('desc').value
      };
      const existing = JSON.parse(localStorage.getItem('rs_local_props')||'[]');
      existing.unshift(obj);
      localStorage.setItem('rs_local_props', JSON.stringify(existing));
      alert('تم الإضافة محليًا — لتصبح عامة حرّف الملف data/properties.json في الريبو وادمج السجل');
      // optional: redirect to home
      location.href='index.html';
    }
  </script>
</body>
</html>
