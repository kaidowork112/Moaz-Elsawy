<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ALSAWY INVESTMENT</title>
<style>
  body{margin:0;font-family:Arial,sans-serif;background:#f7f7f8;color:#111;}
  header{background:#0a74da;color:white;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;}
  header a{color:white;text-decoration:none;margin-left:12px;font-weight:bold;}
  header a.btn{background:#f5b800;color:#000;padding:6px 12px;border-radius:6px;}

  .slider{position:relative;width:100%;height:300px;overflow:hidden;margin-bottom:30px;cursor:grab;}
  .slides-container{display:flex;transition:transform 0.5s ease-in-out;}
  .slide{min-width:100%;height:300px;background-size:cover;background-position:center;border-radius:12px;position:relative;}
  .caption{position:absolute;bottom:15px;right:20px;background:rgba(0,0,0,0.5);color:#fff;padding:8px 15px;border-radius:6px;}

  .properties{padding:20px;text-align:center;}
  .property-list{display:flex;flex-wrap:wrap;gap:20px;justify-content:center;}
  .property-card{background:#fff;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.1);width:280px;cursor:pointer;transition:0.3s;}
  .property-card:hover{transform:translateY(-5px);}
  .property-card img{width:100%;height:180px;border-top-left-radius:12px;border-top-right-radius:12px;object-fit:cover;}
  .property-info{padding:10px;text-align:right;}
  .property-info h3{color:#333;margin-bottom:5px;}
  .property-info p{font-size:14px;color:#666;margin:3px 0;}
  .property-info span{color:#f5b800;font-weight:bold;display:block;margin-top:5px;}

  footer{text-align:center;padding:12px 0;color:#f5b800;background:#0a74da;margin-top:22px;border-radius:8px;}
</style>
</head>
<body>

<header>
  <div class="logo">ğŸ  ALSAWY INVESTMENT</div>
  <nav>
    <a href="#properties">Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</a>
    <a href="#" id="loginBtn" class="btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
  </nav>
</header>

<section class="slider" id="slider">
  <div class="slides-container" id="slidesContainer"></div>
</section>

<section class="properties" id="properties">
  <h2>Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
  <div id="propertyList" class="property-list"></div>
</section>

<footer>Â© 2025 ALSAWY INVESTMENT | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyBxEWaPWqpUIgZtasxnE7-82SN6OEzSx7Q",
  authDomain: "moaz-elsawy.firebaseapp.com",
  projectId: "moaz-elsawy",
  storageBucket: "moaz-elsawy.appspot.com",
  messagingSenderId: "859568017117",
  appId: "1:859568017117:web:38a7d0c96532f0f7681534",
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

// Ø¹Ù†Ø§ØµØ± DOM
const slidesContainer = document.getElementById('slidesContainer');
const propertyList = document.getElementById('propertyList');
const loginBtn = document.getElementById('loginBtn');

let slides = [], slideIndex = 0, sliderInterval;

// Ø¬Ù„Ø¨ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ù…Ù† Firestore
async function loadProperties() {
  const col = collection(db, 'properties');
  const q = query(col, orderBy('id','asc'));
  const snapshot = await getDocs(q);

  slidesContainer.innerHTML = '';
  propertyList.innerHTML = '';
  slides = [];

  snapshot.forEach(doc=>{
    const p = doc.data();

    // Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
    if(p.showSlider){
      const slide = document.createElement('div');
      slide.className='slide';
      slide.style.backgroundImage = `url(${p.image})`;
      const caption = document.createElement('div');
      caption.className='caption';
      caption.textContent = `${p.title} â€” ${p.price}`;
      slide.appendChild(caption);
      slidesContainer.appendChild(slide);
      slides.push(slide);
    }

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª
    const card = document.createElement('div');
    card.className='property-card';
    card.innerHTML=`
      <img src="${p.image}" alt="${p.title}" />
      <div class="property-info">
        <h3>${p.title}</h3>
        ${p.location?`<p>${p.location}</p>`:''}
        <span>${p.price}</span>
      </div>`;
    propertyList.appendChild(card);
  });

  startSlider();
}

// Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ø³Ø­Ø¨
function startSlider(){
  if(slides.length===0) return;

  clearInterval(sliderInterval);
  sliderInterval = setInterval(()=>{
    slideIndex = (slideIndex+1)%slides.length;
    slidesContainer.style.transform=`translateX(-${slideIndex*100}%)`;
  },3000);

  let isDragging=false, startX=0, currentTranslate=0, prevTranslate=0;

  slidesContainer.addEventListener('mousedown',startDrag);
  slidesContainer.addEventListener('touchstart',startDrag);
  slidesContainer.addEventListener('mouseup',endDrag);
  slidesContainer.addEventListener('touchend',endDrag);
  slidesContainer.addEventListener('mousemove',drag);
  slidesContainer.addEventListener('touchmove',drag);

  function startDrag(e){
    isDragging=true;
    startX = e.type.includes('mouse') ? e.pageX : e.touches[0].clientX;
    clearInterval(sliderInterval);
  }
  function drag(e){
    if(!isDragging) return;
    const x = e.type.includes('mouse') ? e.pageX : e.touches[0].clientX;
    const delta = x - startX;
    slidesContainer.style.transform = `translateX(${ -slideIndex*100 + delta/slidesContainer.offsetWidth*100 }%)`;
  }
  function endDrag(e){
    if(!isDragging) return;
    isDragging=false;
    const x = e.type.includes('mouse') ? e.pageX : e.changedTouches[0].clientX;
    const delta = x - startX;
    if(delta > 50) slideIndex = Math.max(slideIndex-1,0);
    else if(delta < -50) slideIndex = Math.min(slideIndex+1,slides.length-1);
    slidesContainer.style.transform=`translateX(-${slideIndex*100}%)`;
    startSlider();
  }
}

// Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„/Ø§Ù„Ø®Ø±ÙˆØ¬
onAuthStateChanged(auth, user=>{
  if(user){
    loginBtn.textContent='ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬';
    loginBtn.onclick = ()=>{ signOut(auth); }
  } else {
    loginBtn.textContent='ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
    loginBtn.onclick = ()=>{ window.location.href='login.html'; }
  }
});

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
loadProperties();

</script>
</body>
</html>
