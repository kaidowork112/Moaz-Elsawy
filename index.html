// استبدال جزء loadProperties في script.js
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBxEWaPWqpUIgZtasxnE7-82SN6OEzSx7Q",
  authDomain: "moaz-elsawy.firebaseapp.com",
  projectId: "moaz-elsawy",
  storageBucket: "moaz-elsawy.firebasestorage.app",
  messagingSenderId: "859568017117",
  appId: "1:859568017117:web:38a7d0c96532f0f7681534",
  measurementId: "G-JY1XN1VRCP"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadProperties() {
  const listContainer = document.getElementById("property-list");
  listContainer.innerHTML = '';

  const snapshot = await getDocs(collection(db,"properties"));
  const allProperties = [];
  snapshot.forEach(docSnap => allProperties.push({ id: docSnap.id, ...docSnap.data() }));

  if(allProperties.length === 0){
    listContainer.innerHTML = '<p style="text-align:center; padding:40px 0; color:#666;">لا توجد عقارات حالياً.</p>';
    return;
  }

  allProperties.forEach((prop) => {
    const card = document.createElement("div");
    card.className = "property-card";
    card.dataset.id = prop.id;
    card.innerHTML = `
      <img src="${prop.img}" alt="${prop.title}">
      <div class="property-info">
        <h3>${prop.title}</h3>
        <p><strong>الموقع:</strong> ${prop.location}</p>
        <p><strong>الغرف:</strong> ${prop.rooms || '؟'}</p>
        <span>${prop.price}</span>
      </div>
    `;
    listContainer.appendChild(card);

    card.addEventListener('click', () => openModal(prop.id));
  });
}

document.addEventListener("DOMContentLoaded", () => {
  loadProperties();
});
