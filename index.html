<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Moaz Elsawy | ØªØ³ÙˆÙŠÙ‚ Ø¹Ù‚Ø§Ø±ÙŠ</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { font-family: "Cairo", sans-serif; background:#f4f8ff; margin:0; }
    .header { background:#0a74da; color:white; display:flex; justify-content:space-between; align-items:center; padding:15px 20px; }
    .header nav a { color:white; text-decoration:none; margin-left:15px; }
    .header nav a.btn { background:#f5b800; color:#000; padding:6px 12px; border-radius:6px; }

    /* Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± */
    .slider { position:relative; width:100%; height:300px; overflow:hidden; margin-bottom:30px; }
    .slides-container { display:flex; transition: transform 0.5s ease-in-out; }
    .slide { min-width:100%; height:300px; background-size:cover; background-position:center; border-radius:12px; cursor:pointer; margin:0 5px; position:relative; }
    .caption { position:absolute; bottom:15px; right:20px; background:rgba(0,0,0,0.5); color:#fff; padding:8px 15px; border-radius:6px; }

    /* Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª */
    .properties { padding:20px; text-align:center; }
    .property-list { display:flex; flex-wrap:wrap; gap:20px; justify-content:center; }
    .property-card { background:#fff; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.1); width:280px; cursor:pointer; transition:0.3s; }
    .property-card:hover { transform:translateY(-5px); }
    .property-card img { width:100%; height:180px; border-top-left-radius:12px; border-top-right-radius:12px; object-fit:cover; }
    .property-info { padding:10px; text-align:right; }
    .property-info h3 { color:#333; margin-bottom:5px; }
    .property-info p { font-size:14px; color:#666; margin:3px 0; }
    .property-info span { color:#f5b800; font-weight:bold; display:block; margin-top:5px; }

    /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:1000; }
    .modal-content { background:#fff; max-width:700px; margin:50px auto; border-radius:12px; padding:20px; position:relative; }
    .close-button { position:absolute; left:20px; top:10px; font-size:28px; cursor:pointer; color:#aaa; }
    .close-button:hover { color:#000; }
    #modalDetails img { width:100%; max-height:400px; object-fit:cover; border-radius:8px; margin-bottom:15px; }
    #modalDetails h2 { color:#0a74da; margin-bottom:10px; }
    #modalDetails p { margin:8px 0; font-size:15px; }
    .whatsapp-btn { display:block; width:100%; text-align:center; background:#25d366; color:#fff; padding:12px 0; font-weight:bold; border-radius:8px; text-decoration:none; margin-top:15px; }

    /* ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ */
    .contact { background:#fff; padding:50px 20px; text-align:center; }
    .contact input, .contact textarea, .contact button { width:90%; max-width:400px; margin:5px 0; padding:10px; border-radius:6px; border:1px solid #ccc; }
    .contact button { background:#f5b800; border:none; cursor:pointer; font-weight:600; }
    .contact button:hover { background:#ffcc33; }
  </style>
</head>
<body>

  <header class="header">
    <div class="logo">ğŸ  Moaz Elsawy</div>
    <nav>
      <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="#properties">Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</a>
      <a href="#contact">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
      <a href="#" id="loginBtn" class="btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
    </nav>
  </header>

  <!-- Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± -->
  <section class="slider" id="slider">
    <div class="slides-container" id="slidesContainer"></div>
  </section>

  <!-- Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª -->
  <section id="properties" class="properties">
    <h2>Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
    <div id="property-list" class="property-list"></div>
  </section>

  <!-- ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ -->
  <section id="contact" class="contact">
    <h2>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h2>
    <form id="contactForm">
      <input type="text" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required>
      <input type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
      <textarea placeholder="Ø±Ø³Ø§Ù„ØªÙƒ..." required></textarea>
      <button type="submit">Ø¥Ø±Ø³Ø§Ù„</button>
    </form>
  </section>

  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
  <div id="propertyModal" class="modal">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <div id="modalDetails">
        <img id="modalImg" src="" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±">
        <h2 id="modalTitle"></h2>
        <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> <span id="modalPriceDetail"></span></p>
        <p><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> <span id="modalCity"></span></p>
        <p><strong>Ø§Ù„Ù†ÙˆØ¹:</strong> <span id="modalType"></span></p>
        <p><strong>Ø¹Ø¯Ø¯ Ø§Ù„ØºØ±Ù:</strong> <span id="modalRooms"></span></p>
        <p><strong>Ø§Ù„ÙˆØµÙ:</strong> <span id="modalDesc"></span></p>
        <a id="whatsappLink" href="#" target="_blank" class="whatsapp-btn">ØªÙˆØ§ØµÙ„ ÙˆØ§ØªØ³Ø§Ø¨ (Ø§Ø³ØªÙØ³Ø± Ø§Ù„Ø¢Ù†)</a>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyBxEWaPWqpUIgZtasxnE7-82SN6OEzSx7Q",
      authDomain: "moaz-elsawy.firebaseapp.com",
      projectId: "moaz-elsawy",
      storageBucket: "moaz-elsawy.firebasestorage.app",
      messagingSenderId: "859568017117",
      appId: "1:859568017117:web:38a7d0c96532f0f7681534",
      measurementId: "G-JY1XN1VRCP"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let ALL_PROPERTIES = [];
    let SLIDER_PROPERTIES = [];
    let currentSlide = 0;

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª
    async function loadProperties() {
      const querySnapshot = await db.collection("properties").get();
      const allProps = [];
      const sliderProps = [];

      querySnapshot.forEach(doc => {
        const prop = { id: doc.id, ...doc.data() };
        allProps.push(prop);
        if (prop.slider) sliderProps.push(prop);
      });

      ALL_PROPERTIES = allProps;
      SLIDER_PROPERTIES = sliderProps;

      displayProperties(ALL_PROPERTIES);
      displaySlider(SLIDER_PROPERTIES);
    }

    function displayProperties(properties) {
      const listContainer = document.getElementById("property-list");
      listContainer.innerHTML = '';
      if (!properties.length) {
        listContainer.innerHTML = '<p style="text-align:center; padding: 40px 0; color:#666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚Ø§Ø±Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</p>';
        return;
      }

      properties.forEach(prop => {
        const card = document.createElement("div");
        card.className = "property-card";
        card.dataset.id = prop.id;

        card.innerHTML = `
          <img src="${prop.img}" alt="${prop.title}">
          <div class="property-info">
            <h3>${prop.title}</h3>
            <p><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${prop.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
            <p><strong>Ø§Ù„ØºØ±Ù:</strong> ${prop.rooms || 'ØŸ'}</p>
            <span>${prop.price}</span>
          </div>
        `;

        card.addEventListener('click', () => openModal(prop.id));
        listContainer.appendChild(card);
      });
    }

    function displaySlider(sliderProps) {
      const container = document.getElementById("slidesContainer");
      container.innerHTML = '';

      sliderProps.forEach(prop => {
        const slide = document.createElement("div");
        slide.className = "slide";
        slide.style.backgroundImage = `url(${prop.img})`;
        const caption = document.createElement("div");
        caption.className = "caption";
        caption.textContent = prop.title;
        slide.appendChild(caption);
        slide.addEventListener("click", () => openModal(prop.id));
        container.appendChild(slide);
      });

      startSlider();
    }

    function startSlider() {
      const slides = document.querySelectorAll(".slide");
      if (!slides.length) return;

      setInterval(() => {
        currentSlide = (currentSlide + 1) % slides.length;
        const container = document.getElementById("slidesContainer");
        container.style.transform = `translateX(-${currentSlide * 100}%)`;
      }, 3000);
    }

    // Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„
    function openModal(propertyId) {
      const prop = ALL_PROPERTIES.find(p => p.id === propertyId);
      if (!prop) return;

      document.getElementById('modalImg').src = prop.img;
      document.getElementById('modalTitle').textContent = prop.title;
      document.getElementById('modalPriceDetail').textContent = prop.price;
      document.getElementById('modalCity').textContent = prop.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      document.getElementById('modalType').textContent = prop.type || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      document.getElementById('modalRooms').textContent = prop.rooms || 'ØŸ';
      document.getElementById('modalDesc').textContent = prop.desc || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù…ØªØ§Ø­ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø§Ø±.';
      const encodedMessage = encodeURIComponent(`Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£ÙˆØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø¹Ù‚Ø§Ø±: ${prop.title}ØŒ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø©: ${prop.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}. Ø³Ø¹Ø±Ù‡: ${prop.price}. Ù‡Ù„ Ù‡Ùˆ Ù…ØªØ§Ø­ØŸ`);
      document.getElementById('whatsappLink').href = `https://wa.me/+201115134784?text=${encodedMessage}`;

      document.getElementById('propertyModal').style.display = 'block';
    }

    document.querySelector('.close-button').onclick = () => {
      document.getElementById('propertyModal').style.display = 'none';
    };
    window.onclick = (event) => {
      if (event.target == document.getElementById('propertyModal')) {
        document.getElementById('propertyModal').style.display = 'none';
      }
    };

    document.addEventListener("DOMContentLoaded", () => {
      loadProperties();

      // Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„/Ø§Ù„Ø®Ø±ÙˆØ¬
      const loginBtn = document.getElementById("loginBtn");
      const user = JSON.parse(localStorage.getItem("realestate_user") || "{}");
      if (user && user.email) {
        loginBtn.textContent = "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬";
        loginBtn.onclick = (e) => {
          e.preventDefault();
          localStorage.removeItem("realestate_user");
          location.reload();
        };
      } else {
        loginBtn.href = "login.html";
      }

      document.getElementById("contactForm").addEventListener("submit", (e) => {
        e.preventDefault();
        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­ âœ…");
        e.target.reset();
      });
    });
  </script>
</body>
</html>
